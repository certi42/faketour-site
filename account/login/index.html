<!DOCTYPE html>
<html>
<head>
    <title>Log In | Faketour</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="/menu/styles.css">
    <script type="text/javascript" src="/menu/loadMenu.js"></script>
</head>

<body>
<div class="topnav"></div>
<div class="content"></div>
<script type="text/javascript">loadMenu("Log In");</script>
<h2>Log In</h2>
<form onsubmit="login(); return false;">
    <div class="imgcontainer">
        <img src="login_avatar.png" alt="Avatar" class="avatar">
    </div>
    <div class="container">
        <label for="uname"><b>Username</b></label>
        <input id="uname" type="text" placeholder="Enter Username" name="uname" required>
        <label for="psw"><b>Password</b></label>
        <input id="psw" type="password" placeholder="Enter Password" name="psw" required>
        <input type="checkbox" id='remember' name="remember" value="Remerber">
        <label for="remember"><b>Remember Me</b></label>
        <button type="submit">Login</button>
    </div>
</form>
<div class="footer"><a href="https://twitter.com/DaarkenArt">Artwork by @DaarkenArt</a></div>
<script>
    async function login() {
        let remember = document.getElementById("remember").checked;
        let username = document.getElementById("uname").value;
        let password = document.getElementById("psw").value;
        let inputs = {remember, username, password};
        showAlert("Logging in", "", "info");
        let data = await fetch("login.php", {
            method: 'POST',
            headers: {'Content-Type': 'application/x-www-form-urlencoded'},
            body: Object.keys(inputs).map(e => `${e}=${inputs[e]}`).join('&')
        });
        let response = await data.text();
        if(response === "true") {
            showAlert("Logged in", "Redirecting...", "success");
            history.back();
        } else if (response === "fadetrue") {
            showAlert("Failed to remember", "Log in status not saved", "warning");
        } else {
            showAlert("Failed to login", "Incorrect username or password", "error");
        }
    }
</script>

</body>
</html>
